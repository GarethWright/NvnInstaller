This sample is crearted using Visual Studio C++ 2008 express. 

Steps to create Win 32 EXE

1. Start Visual Studio C++ 2008 Express
2. Click menu File >> New >> Project
3. Select Project type "Win32" and "Win32 Project" from project templates. Enter "Win32DLL" for the project name and click OK.
4. Click "Next" in Win 32 Application Wizard. In the second window select "Console Application" as application type and UNCKECK "Precompiled Header" under additional options. Click "Finish"
5. Add following code in Win32Exe.cpp to create "test" directory in "D:"

#include "stdafx.h"
#include <stdio.h>
#include <direct.h>
#include <string>
using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
	if(argc == 2)
	{
		string folderName(argv[1]);
		mkdir(folderName.c_str());
	}
	return 0;
}

6. Right click project and select "Properties".
7. Set "Character Set" to "Not Set". This property appears under "Configuration Properties" >> "General".

Now compile this project (Build >> Rebuild Solution). Our EXE is ready !

Using Win32 EXE with Nvn Installer.

1. Start Nvn Installer.
2. Set all necessory properties in "Product Information" tab.
5. Select "Custom Actions" tab. 
6. Select "Exe" for custom action type and click "Add Custom Action".
If Exe is one of the file being installed
	A. Select "Components" tab (left side)
	B. Set Destination folder and add above application file under it.
	C. Select "True" for "Is part of installation".
	D. Now Click "..." which shows components under destination folder.
	E. Select "Exe" file in popup window.
If custom action Exe is a binary file (which is cleaned by windows installer after installation). 
	A. Select "False" for "Is part of installation".
	D. Now Click "..." which shows normal file select dialog. Locate custom action DLL we created above.
7. Set "d:\test" for command line arrguments.
8. Select appropriate value for "When?", for example "Installation" if you want to execute this custom action only during installation. Go to http://www.nvninstaller.com/help/customactions/exe-custom-actions to know more about it.
9.  Select menu "Project" >> "Build" or Press F5 to build MSI package.

Now execute the setup package generated by Nvn Installer and check whether "test" directory is created in "D:" after installation.


Security Note

This sample is provided to illustrate a concept and should not be used in applications or Web sites. Naveen Hegde, author of Nvn Installer assumes no liability for incidental or consequential damages should the sample be used for purposes other than as intended.